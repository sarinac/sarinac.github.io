<!doctype html><html lang=en prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Spotify Flowers | If Colorful</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Sarina Chen"><meta name=description content="Portfolio of Sarina Chen"><meta name=description property="og:description" content="Portfolio of Sarina Chen"><meta name=image property="og:image" content="https://ifcolorful.com/_general/preview.png"><meta name=twitter:image content="https://ifcolorful.com/_general/preview.png"><link rel=icon href=https://ifcolorful.com/_general/favicon.svg type=image/x-icon><link rel="shortcut icon" href=https://ifcolorful.com/_general/favicon.svg type=image/x-icon><link rel=stylesheet href=/css/main.css></head><body><nav class=main-navigation><a href=https://ifcolorful.com/ class=main-navigation-logo><svg id="ifcolorful-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 356.0831 71.2166"><defs><style>.gray{fill:#648585}.yellow{fill:#eaac61}.green{fill:#20cc94}.blue{fill:#00a1e1}.purple{fill:#a58eff}.text{fill:#f7f8f9}</style></defs><rect class="gray" width="71.2166" height="71.2166"/><rect class="yellow" x="71.2166" width="71.2166" height="71.2166"/><rect class="green" x="142.4333" width="71.2166" height="71.2166"/><rect class="blue" x="213.6499" width="71.2166" height="71.2166"/><rect class="purple" x="284.8665" width="71.2166" height="71.2166"/><path class="text" d="M141.8116 321.0127H137.24V294.4416h-8.993v-3.9549h13.5645zm-2.2282-42.07a2.9723 2.9723.0 012.1987.9228 3.0455 3.0455.0 01.9068 2.2121 3.0867 3.0867.0 01-.8934 2.2563 2.9826 2.9826.0 01-2.2121.9082 2.8769 2.8769.0 01-2.1239-.9523 3.0826 3.0826.0 01-.9229-2.2122 3.0341 3.0341.0 01.9229-2.1974A2.9006 2.9006.0 01139.5834 278.9432z" transform="translate(-121.9584 -264.3917)"/><path class="text" d="M185.7254 280.1442l-1.201 3.7208a21.3234 21.3234.0 00-5.8313-.9376q-2.46.0-3.3837 1.3923-.923 1.39-.9229 5.6093v.5577h10.2556v3.9549H174.3865v26.5711h-4.5687V294.4416h-7.677v-3.9549h7.677v-1.0258q0-5.83 1.9928-8.1732 1.99-2.3452 6.8825-2.3445A23.9489 23.9489.0 01185.7254 280.1442z" transform="translate(-121.9584 -264.3917)"/><path class="text" d="M221.3231 319.9869a20.8687 20.8687.0 01-8.76 1.8162q-7.2063.0-11.5-4.3788t-4.2905-11.6452q0-7.2663 4.32-11.6452a15.24 15.24.0 0111.3523-4.38 24.0535 24.0535.0 018.76 1.6116l-1.2011 3.7783a23.2883 23.2883.0 00-7.5-1.4351 10.24 10.24.0 00-7.9846 3.2514q-2.941 3.252-2.9424 8.8191a12.5193 12.5193.0 003.0467 8.5691 10.0611 10.0611.0 007.9392 3.4707 23.2013 23.2013.0 007.9685-1.494z" transform="translate(-121.9584 -264.3917)"/><path class="text" d="M245.6085 289.7538a12.4492 12.4492.0 0110.0175 4.3948q3.72 4.3936 3.7208 11.5717.0 7.2363-3.7208 11.66a13.5892 13.5892.0 01-20.051.0147q-3.7075-4.41-3.7075-11.6746.0-7.2062 3.7208-11.5864A12.4722 12.4722.0 01245.6085 289.7538zm0 28.0651a7.5465 7.5465.0 006.5616-3.5149 16.6768 16.6768.0 00.0294-17.1969 8.1238 8.1238.0 00-13.1846-.0441 17.0166 17.0166.0 00.0294 17.2852A7.526 7.526.0 00245.6085 317.8189z" transform="translate(-121.9584 -264.3917)"/><path class="text" d="M291.221 321.0127H278.74V283.6309h-7.9686v-3.9548h12.54v37.3818h7.91z" transform="translate(-121.9584 -264.3917)"/><path class="text" d="M317.6169 289.7538a12.4492 12.4492.0 0110.0175 4.3948q3.72 4.3936 3.7208 11.5717.0 7.2363-3.7208 11.66a13.5892 13.5892.0 01-20.051.0147q-3.7075-4.41-3.7075-11.6746.0-7.2062 3.7208-11.5864A12.4722 12.4722.0 01317.6169 289.7538zm0 28.0651a7.5465 7.5465.0 006.5616-3.5149 16.6768 16.6768.0 00.0294-17.1969 8.1238 8.1238.0 00-13.1846-.0441 17.0166 17.0166.0 00.0294 17.2852A7.526 7.526.0 00317.6169 317.8189z" transform="translate(-121.9584 -264.3917)"/><path class="text" d="M365.9283 291.3066l-1.8456 4.3948a13.4166 13.4166.0 00-5.2161-1.3187 7.5988 7.5988.0 00-3.9535 1.1569 12.6727 12.6727.0 00-3.56 3.31 11.9579 11.9579.0 00-1.6263 2.4168v19.7461h-4.542v-30.526h4.542v6.18q3.6632-6.9134 9.4932-6.9133A15.4094 15.4094.0 01365.9283 291.3066z" transform="translate(-121.9584 -264.3917)"/><path class="text" d="M401.756 280.1442l-1.201 3.7208a21.3245 21.3245.0 00-5.8313-.9376q-2.46.0-3.3838 1.3923-.9228 1.39-.9228 5.6093v.5577h10.2556v3.9549H390.4171v26.5711h-4.5687V294.4416h-7.677v-3.9549h7.677v-1.0258q0-5.83 1.9928-8.1732 1.99-2.3452 6.8825-2.3445A23.9489 23.9489.0 01401.756 280.1442z" transform="translate(-121.9584 -264.3917)"/><path class="text" d="M437.4071 321.0127h-4.5687v-4.5112q-4.9231 5.2441-10.3706 5.2441-8.5865.0-8.5838-10.4V290.4867h4.5687v19.54a10.958 10.958.0 001.2305 5.8152 4.5627 4.5627.0 004.1622 1.9193q4.1889.0 8.993-5.2148v-22.06h4.5687z" transform="translate(-121.9584 -264.3917)"/><path class="text" d="M471.2446 321.0127H458.7635V283.6309H450.795v-3.9548h12.54v37.3818h7.91z" transform="translate(-121.9584 -264.3917)"/></svg></a><div class=sub-navigation><a href=https://ifcolorful.com/about class=sub-navigation-link id=nav-about>About</a>
<a href=https://ifcolorful.com/showcase class=sub-navigation-link id=nav-showcase>Showcase</a>
<a href=https://ifcolorful.com/projects class=sub-navigation-link id=nav-all-projects>All Projects</a></div></nav><div class=content-wrapper style=padding-bottom:0><div class=showcase-summary><div class=showcase-summary-left><div class=showcase-summary-subtitle><p>Web Application & Visualization</p></div><div class=showcase-summary-title><h1>Spotify Flowers</h1></div><div class=showcase-summary-description><p>I built a web application that converts any song on Spotify into a bouquet of flowers based on its audio analysis.</p></div><div class=showcase-summary-buttons><div class=showcase-summary-button><a href=https://spotifyflowers.ifcolorful.com/ class=check-it-out>Check It Out</a></div><div class=showcase-summary-button><a href=https://github.com/sarinac/spotify-flowers class=check-it-out>See Code</a></div></div></div><div class=showcase-summary-right><div class=showcase-summary-tool><p>Spotify API</p></div><div class=showcase-summary-tool><p>Photoshop</p></div><div class=showcase-summary-tool><p>pandas</p></div><div class=showcase-summary-tool><p>flask</p></div><div class=showcase-summary-tool><p>D3.js</p></div><div class=showcase-summary-tool><p>Heroku</p></div></div></div><div class=showcase-picture style=background-image:url(https://ifcolorful.com/projects/spotify-flowers/cover.png)></div></div><div class="content-wrapper project-description" style=padding-top:0><h1 id=overview>Overview</h1><p><strong>I worked on this project in 2 phases: Proof of Concept and Productionizing.</strong> Phase 1 includes creating the standalone visual, which took roughly 4 weeks. Phase 2 includes using Python <code>flask</code> to build the application, generalizing layout of the flower visual, and deploying, which took roughly another 4 weeks. I started Phase 2 6 months after completing Phase 1 because I learned about deploying data applications from the Data Engineering team at work. In that 6 month gap, I improved as a developer with the help of my coworkers and my series of personal projects that I felt ready to productionize my work.</p><h1 id=part-1-creating-the-proof-of-concept>Part 1: Creating the Proof of Concept</h1><p>In my standalone visual, I knew I wanted to work with a song from the Electroswing genre. It&rsquo;s jazzy, groovy, and more complex than mainstream pop songs. I chose <em>Lone Digger by Caravan Palace</em> because I was familiar enough with how the song goes to be able to work with it.</p><h2 id=data-collection>Data Collection</h2><p>I began my design process by browsing the <a href=https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-analysis/>Spotify API</a> to see what data was available. I used Jupyter Notebook to check out samples of data from the relevant endpoints, like artist, track, audio analysis. Everything was straightforward to me except for the <strong>chroma vector</strong>. The data structure looked so odd, and there was a lack of examples online. <a href=https://en.wikipedia.org/wiki/Chroma_feature>Wikipedia</a> actually had the best explanation of the chroma feature because of the visual. This allowed me to replicate it using <code>matplotlib</code>.</p><p><img src=chroma_vector.png alt></p><p>In this process, I realized that music is an opportunistic space with interesting data and not much existing visualization. Most of the visuals I saw were research-based, and didn&rsquo;t look aesthetic. It would be fun to make this chroma feature look pretty and fascinating at the same time.</p><h2 id=mockups>Mockups</h2><p>I started by drawing random objects on a piece of paper to visualize data with the hierarchal structure of sections, bars, and individual notes. I decided to go with flowers (inspired by <a href=http://bl.ocks.org/sxywu/raw/d612c6c653fb8b4d7ff3d422be164a5d/>film flowers by Shirley Wu</a>) because I could split it into 3 layers (flower, petals, petal colors). I hard coded the positions based on the order on the x-axis and section pitches on the y-axis.</p><p>After building the flower skeleton, I used Photoshop in my planning stage to figure out how to paint the flowers using individual notes. Based on my Photoshop mindset, I used a blur brush and clipping mask, which I would replicate with code using the <a href=https://developer.mozilla.org/en-US/docs/Web/SVG/Element/defs><code>&lt;defs></code> element</a>.</p><p><img src=draft-1.png alt></p><h2 id=coding-with-d3>Coding with D3</h2><p>The biggest challenge I had was passing data from one level of the hierarchy to the next. Not having much experience working with JSON, I defaulted to exporting my data as a .csv flat file, but it made the link between flowers, petals (subset of flower), and notes (subset of petal) impossible. Doing other tasks like creating a clipping mask was difficult in combination with solving the hierarchal data structure. I redid my data format by converting it to JSON, and my data&rsquo;s subset-building functions magically worked with the following usage of <code>.data()</code> in D3.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=color:#75af00>d3</span><span style=color:#111>.</span><span style=color:#75af00>selectAll</span><span style=color:#111>(</span><span style=color:#d88200>&#34;g&#34;</span><span style=color:#111>)</span>
	<span style=color:#111>.</span><span style=color:#75af00>data</span><span style=color:#111>(</span><span style=color:#75af00>flowerJSON</span><span style=color:#111>)</span>
	<span style=color:#111>.</span><span style=color:#75af00>enter</span><span style=color:#111>()</span>
	<span style=color:#111>.</span><span style=color:#75af00>append</span><span style=color:#111>(</span><span style=color:#d88200>&#34;g&#34;</span><span style=color:#111>)</span>
		<span style=color:#111>.</span><span style=color:#75af00>attr</span><span style=color:#111>(</span><span style=color:#d88200>&#34;x&#34;</span><span style=color:#111>,</span> <span style=color:#75af00>d</span> <span style=color:#111>=&gt;</span> <span style=color:#75af00>d</span><span style=color:#111>.</span><span style=color:#75af00>x</span><span style=color:#111>)</span> <span style=color:#75715e>// x-position of pistil
</span><span style=color:#75715e></span>		<span style=color:#111>.</span><span style=color:#75af00>attr</span><span style=color:#111>(</span><span style=color:#d88200>&#34;y&#34;</span><span style=color:#111>,</span> <span style=color:#75af00>d</span> <span style=color:#111>=&gt;</span> <span style=color:#75af00>d</span><span style=color:#111>.</span><span style=color:#75af00>y</span><span style=color:#111>)</span> <span style=color:#75715e>// y-position of pistil
</span><span style=color:#75715e></span>		<span style=color:#111>.</span><span style=color:#75af00>selectAll</span><span style=color:#111>(</span><span style=color:#d88200>&#34;path&#34;</span><span style=color:#111>)</span>
		<span style=color:#111>.</span><span style=color:#75af00>data</span><span style=color:#111>(</span><span style=color:#75af00>f</span> <span style=color:#111>=&gt;</span> <span style=color:#75af00>f</span><span style=color:#111>.</span><span style=color:#75af00>petals</span><span style=color:#111>)</span>
		<span style=color:#111>.</span><span style=color:#75af00>enter</span><span style=color:#111>()</span>
		<span style=color:#111>.</span><span style=color:#75af00>append</span><span style=color:#111>(</span><span style=color:#d88200>&#34;path&#34;</span><span style=color:#111>)</span>
			<span style=color:#111>.</span><span style=color:#75af00>attr</span><span style=color:#111>(</span><span style=color:#d88200>&#34;d&#34;</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;M0,0 Z&#34;</span><span style=color:#111>);</span> <span style=color:#75715e>// insert path for drawing a single petal
</span></code></pre></div><p>Besides things not working the way I wanted for a long time, another mental drain was the visual not looking as good as I planned. I couldn&rsquo;t make my results look like the one I had photoshopped because I was &ldquo;using real data&rdquo; (and needed to stay true to it). I experimented with different backgrounds, chroma thresholds, colors, and the feature that made it look GREAT ended up being the computationally expensive Gaussian blur. This visual loads pretty slow if I ran a simulation on it, so I loaded the filter <em>after</em> the simulation when I worked on Phase 2.</p><p>The following 2 images are my drafts that didn&rsquo;t look good with the chroma vector. The first image doesn&rsquo;t have enough blur and has a background that acts as additive light, so it&rsquo;s hard to see the pitches if the flower has many petals. The second image has the blur I want but didn&rsquo;t have the right background; the flowers look like they have holes.</p><p><img src=draft-2.png alt></p><p><img src=draft-3.png alt></p><h2 id=final-proof-of-concept>Final Proof of Concept</h2><p>We are <strong>done</strong> after a lot of editing!</p><p><img src=draft-4.png alt></p><p>I also added my interpretation notes when you hover over the button &ldquo;hover for notes&rdquo; on the bottom left.</p><p><img src=draft-5.png alt></p><h1 id=part-2-productionizing-as-a-web-application>Part 2: Productionizing as a Web Application</h1><h2 id=refactoring-code>Refactoring Code</h2><p>My main goal in refactoring was the following:</p><ul><li>Generalize my javcascript code to draw flowers for any song<ul><li>Build a simulation to determine the positions of all flowers because I hard-coded the x and y positions for flowers that I created in my original work.</li><li>Turn my visual into a <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes><code>class</code></a> for better organization.</li></ul></li><li>Turn my Jupyter Notebook of data wrangling into a python class that does the following:<ul><li>Use the <a href=https://developer.spotify.com/documentation/web-api/reference/search/search/>Spotify Search API</a> to retrieve the track&rsquo;s URI based on user input.</li><li>Use the <a href=https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-analysis/>Spotify Audio Analysis API</a> to get the breakdown of the song.</li><li>Manipulate the data with <code>pandas</code> and return a JSON.</li></ul></li><li>Build a python <code>Flask</code> object that would feed the generated data from the server into the javascript, client-side script.</li><li>Deploy the new web application using <a href=https://dashboard.heroku.com/>Heroku</a>.</li></ul><p>See <a href=https://github.com/sarinac/spotify-flowers>my GitHub</a> for the final result!</p><h2 id=using-python-flask>Using Python Flask</h2><p>I used this <a href="https://www.youtube.com/watch?v=MwZwr5Tvyxo&list=PL-osiE80TeTs4UjLw5MM6OjgkjFeUxCYH">YouTube tutorial by Corey Schafer</a> to get started on using <a href=https://flask.palletsprojects.com/en/1.1.x/tutorial/templates/><code>flask</code></a>.</p><p>Since I already made a standalone version, I created a <code>templates</code> subdirectory, a default location for <code>flask</code> and replaced a lot of my <code>index.html</code> code with expressions enclosed in double brackets.</p><p>To send the data JSON over from the server (python web application) to the client (javascript), I added the data as a parameter in <code>flask</code>&rsquo;s <code>render_template</code> function.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=color:#75af00>@app.route</span><span style=color:#111>(</span><span style=color:#d88200>&#34;/grow&#34;</span><span style=color:#111>)</span>
<span style=color:#00a8c8>def</span> <span style=color:#75af00>grow</span><span style=color:#111>():</span>
	<span style=color:#d88200>&#34;&#34;&#34;
</span><span style=color:#d88200>	This code does stuff before returning.
</span><span style=color:#d88200>	&#34;&#34;&#34;</span>
	<span style=color:#00a8c8>return</span> <span style=color:#111>render_template</span><span style=color:#111>(</span>
        <span style=color:#d88200>&#34;index.html&#34;</span><span style=color:#111>,</span>
        <span style=color:#111>dataset</span><span style=color:#f92672>=</span><span style=color:#111>dataset</span><span style=color:#111>,</span>
    <span style=color:#111>)</span>
</code></pre></div><p>My <code>index.html</code> has this line to receive the data (the parameter <code>dataset</code> should match between the 2 files). <em>This actually took 5ever to figure out&mldr;</em></p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-html data-lang=html><span style=color:#111>&lt;</span><span style=color:#f92672>script</span><span style=color:#111>&gt;</span><span style=color:#00a8c8>var</span> <span style=color:#75af00>data</span> <span style=color:#f92672>=</span> <span style=color:#111>{{</span> <span style=color:#75af00>dataset</span><span style=color:#f92672>|</span><span style=color:#75af00>tojson</span> <span style=color:#111>}};&lt;/</span><span style=color:#f92672>script</span><span style=color:#111>&gt;</span>
</code></pre></div><p>The following line in the HTML script uses the <code>data</code> variable to construct the visualization.</p><h2 id=repositioning-flowers-with-d3>Repositioning Flowers with D3</h2><p>While I didn&rsquo;t have to change much of the core logic in my visualization script, I had to find a new way to generate flower positions dynamically. D3&rsquo;s simulation has <code>forceCollide</code> and <code>forceCenter</code> (or <code>forceX</code> and <code>forceY</code>) that would help center the flowers while avoiding collision.</p><p>My result below accomplished the spaced-out flowers that I wanted, but introduced a new problem: the x-axis was no longer ordered. I created a flower stems that showed what each section&rsquo;s order was, and this randomness from the simulation made it look tangled and messy.</p><p><img src=messy-stems.png alt></p><p>I changed the simulation so that it would position flowers along the x-axis before centering them. I had some trouble with their starting positions because D3 would ignore the x and y positions I set for my group elements before running the simulation. This is why all the stems unintentionally pointed towards the <code>(0, 0)</code> coordinate below. I also replaced the flowers with black circles because the flowers' gaussian blur filters made everything lag.</p><p><img src=wrong-starting-position.png alt></p><p>There were 2 ways to set the starting positions along the x-axis:</p><ol><li>Set the elements' position attributes using <code>d.fx</code> instead of <code>d.x</code>. D3&rsquo;s <a href=https://github.com/d3/d3-force/blob/master/src/simulation.js>source code</a> has a method called <code>initalizeNodes</code> that would check if the node positions should be <strong>fixed</strong>. I would set the fixed position and then make it <code>null</code> after the simulation&rsquo;s alpha (&ldquo;entropy level&rdquo;) is under some threshold.</li><li>Create forces that would set each flower&rsquo;s gravity toward&rsquo;s their respective x-position, remove that force, and then reset the simulation with an altered center force. This is like running 2 simulations one after the other.</li></ol><p>I went with option #2 and coded everything within the <code>d3.simulation.on("tick")</code> block. There were 3 possible actions coded as an <code>if</code> statement:</p><ol><li>If the simulation was still active, continue running.</li><li>Else, if we are on Simulation 1 of 2, then restart the simulation and change the forces to reflect Simulation 2 of 2.</li><li>Else, stop the simulation and draw the remaining visual.</li></ol><p>My code is generalized below.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=color:#00a8c8>var</span> <span style=color:#75af00>iteration</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#111>;</span> <span style=color:#75715e>// We are on Simulation 1 of 2
</span><span style=color:#75715e></span><span style=color:#00a8c8>var</span> <span style=color:#75af00>simulation</span> <span style=color:#f92672>=</span> <span style=color:#75af00>d3</span><span style=color:#111>.</span><span style=color:#75af00>forceSimulation</span><span style=color:#111>(</span><span style=color:#75af00>data</span><span style=color:#111>)</span>
    <span style=color:#111>.</span><span style=color:#75af00>force</span><span style=color:#111>(</span><span style=color:#d88200>&#34;x&#34;</span><span style=color:#111>,</span> <span style=color:#75af00>d3</span><span style=color:#111>.</span><span style=color:#75af00>forceX</span><span style=color:#111>().</span><span style=color:#75af00>x</span><span style=color:#111>(</span><span style=color:#75af00>d</span> <span style=color:#111>=&gt;</span> <span style=color:#75af00>d</span><span style=color:#111>.</span><span style=color:#75af00>x</span><span style=color:#111>))</span> <span style=color:#75715e>// Gravitate toward their x-positions
</span><span style=color:#75715e></span>    <span style=color:#111>.</span><span style=color:#75af00>force</span><span style=color:#111>(</span><span style=color:#d88200>&#34;collide&#34;</span><span style=color:#111>,</span> <span style=color:#75af00>d3</span><span style=color:#111>.</span><span style=color:#75af00>forceCollide</span><span style=color:#111>().</span><span style=color:#75af00>radius</span><span style=color:#111>(</span><span style=color:#75af00>d</span> <span style=color:#111>=&gt;</span> <span style=color:#75af00>d</span><span style=color:#111>.</span><span style=color:#75af00>radius</span><span style=color:#111>))</span> <span style=color:#75715e>// Avoid overlapping
</span><span style=color:#75715e></span>    <span style=color:#111>.</span><span style=color:#75af00>on</span><span style=color:#111>(</span><span style=color:#d88200>&#34;tick&#34;</span><span style=color:#111>,</span> <span style=color:#111>()</span> <span style=color:#111>=&gt;</span> <span style=color:#111>{</span>

        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#75af00>simulation</span><span style=color:#111>.</span><span style=color:#75af00>alpha</span><span style=color:#111>()</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.1</span><span style=color:#111>)</span> <span style=color:#111>{</span>
            <span style=color:#75af00>flowers</span>
                <span style=color:#111>.</span><span style=color:#75af00>attr</span><span style=color:#111>(</span><span style=color:#d88200>&#34;transform&#34;</span><span style=color:#111>,</span> <span style=color:#75af00>d</span> <span style=color:#111>=&gt;</span> <span style=color:#d88200>`translate(</span><span style=color:#d88200>${</span><span style=color:#75af00>d</span><span style=color:#111>.</span><span style=color:#75af00>x</span><span style=color:#d88200>}</span><span style=color:#d88200>,</span><span style=color:#d88200>${</span><span style=color:#75af00>d</span><span style=color:#111>.</span><span style=color:#75af00>y</span><span style=color:#d88200>}</span><span style=color:#d88200>)`</span><span style=color:#111>);</span> <span style=color:#75715e>// continue running simulation
</span><span style=color:#75715e></span>
        <span style=color:#111>}</span> <span style=color:#00a8c8>else</span> <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#75af00>iteration</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#111>{</span>
            <span style=color:#75af00>simulation</span><span style=color:#111>.</span><span style=color:#75af00>alpha</span><span style=color:#111>(</span><span style=color:#ae81ff>.5</span><span style=color:#111>).</span><span style=color:#75af00>restart</span><span style=color:#111>();</span> <span style=color:#75715e>// restart simulation with new forces
</span><span style=color:#75715e></span>            <span style=color:#75af00>simulation</span>
                <span style=color:#111>.</span><span style=color:#75af00>force</span><span style=color:#111>(</span><span style=color:#d88200>&#34;center&#34;</span><span style=color:#111>,</span> <span style=color:#75af00>d3</span><span style=color:#111>.</span><span style=color:#75af00>forceCenter</span><span style=color:#111>().</span><span style=color:#75af00>x</span><span style=color:#111>(</span><span style=color:#75af00>width</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span><span style=color:#111>).</span><span style=color:#75af00>y</span><span style=color:#111>(</span><span style=color:#75af00>height</span><span style=color:#f92672>/</span><span style=color:#ae81ff>4</span><span style=color:#111>))</span> <span style=color:#75715e>// Modify this force
</span><span style=color:#75715e></span>                <span style=color:#111>.</span><span style=color:#75af00>force</span><span style=color:#111>(</span><span style=color:#d88200>&#34;x&#34;</span><span style=color:#111>,</span> <span style=color:#75af00>d3</span><span style=color:#111>.</span><span style=color:#75af00>forceX</span><span style=color:#111>().</span><span style=color:#75af00>x</span><span style=color:#111>(</span><span style=color:#75af00>width</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span><span style=color:#111>));</span> <span style=color:#75715e>// Create this new force
</span><span style=color:#75715e></span>            <span style=color:#75af00>iteration</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#111>;</span> <span style=color:#75715e>// We are moving to Simulation 2 of 2
</span><span style=color:#75715e></span>
        <span style=color:#111>}</span> <span style=color:#00a8c8>else</span> <span style=color:#111>{</span>
            <span style=color:#75af00>simulation</span><span style=color:#111>.</span><span style=color:#75af00>stop</span><span style=color:#111>();</span> <span style=color:#75715e>// stop simulation
</span><span style=color:#75715e></span>            <span style=color:#75af00>doRemainingStuff</span><span style=color:#111>();</span> <span style=color:#75715e>// run the remaining steps AFTER simulation
</span><span style=color:#75715e></span>        <span style=color:#111>};</span>
    <span style=color:#111>});</span>
</code></pre></div><p>Now the flowers and stems are positioned where they should be thanks to timing forces correctly!</p><p><img src=success.png alt></p><p>In case you were wondering why I didn&rsquo;t choose option #1, I actually didn&rsquo;t know of it at the time! In retrospect, I think it would have shaved a few ticks off the clock if I had fixed their starting positions. :P</p><h2 id=deploying-on-heroku>Deploying on Heroku</h2><p>I deployed on Heroku because the service has a free tier and several examples of deploying <code>Flask</code> applications. The requirements are pretty simple once you have done it at least once, and it does most of the infrastructure work for you. Following <a href=(https://stackabuse.com/deploying-a-flask-application-to-heroku/)>this guide</a>, I created a <code>requirements.txt</code>, <code>Procfile</code> (Heroku-specific), and <code>runtime.txt</code> (also Heroku-specific).</p><p>One difference I had with the guide was that I added my main script in an <code>app</code> subdirectory. I specified the script&rsquo;s location with a <code>--pythonpath app</code> tag in my <code>Procfile</code>.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=color:#75715e># Conventional command in Procfile</span>
web: gunicorn run:app 

<span style=color:#75715e># My command in Procfile because I had an `app` subdirectory</span>
web: gunicorn --pythonpath app run:app
</code></pre></div><h2 id=my-web-application>My Web Application</h2><p>Try your favorite Spotify song <a href=https://spotify-flowers.ifColorful.com>here</a>! I like showcasing <code>Hamilton</code> because the bouquet is very rich like the song. :P</p><p><img src=final.png alt></p></div><footer><div class=footer-inner><div class=footer-inner-left><div class=footer-icons><a href=mailto:hello@ifcolorful.com><svg width="16" height="14" viewBox="0 0 16 14" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink"><title>email</title><g class="portfolio-contact" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-94.000000, -336.000000)" id="Group" fill="#505050"><g transform="translate(94.000000, 335.000000)"><g id="ui-16px-1_email-84" transform="translate(0.000000, 1.000000)"><path d="M15 0H1C.448.0.0.447.0 1V13C0 13.553.448 14 1 14H15C15.552 14 16 13.553 16 13V1C16 .447 15.552.0 15 0zM14 12H2V5.723L7.504 8.868C7.812 9.044 8.189 9.044 8.496 8.868L14 5.723V12zm0-8.58L8 6.849 2 3.42V2H14V3.42z" id="Shape"/></g></g></g></g></svg></a><a href=https://www.linkedin.com/in/sarinachen/ target=blank><svg width="17" height="16" viewBox="0 0 17 16" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink"><title>linkedin</title><g class="portfolio-contact" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-243.000000, -335.000000)" id="Group" fill="#505050"><g transform="translate(94.000000, 335.000000)"><g id="social-16px_logo-linkedin" transform="translate(149.000000, 0.000000)"><path d="M15.3.0H.7C.3.0.0.3.0.7V15.4C0 15.7.3 16 .7 16H15.4C15.8 16 16.1 15.7 16.1 15.3V.7C16 .3 15.7.0 15.3.0zM4.7 13.6H2.4V6H4.8v7.6H4.7zM3.6 5C2.8 5 2.2 4.3 2.2 3.6 2.2 2.8 2.8 2.2 3.6 2.2S5 2.8 5 3.6C4.9 4.3 4.3 5 3.6 5zm10 8.6H11.2V9.9C11.2 9 11.2 7.9 10 7.9S8.6 8.9 8.6 9.9V13.7H6.2V6H8.5V7C8.8 6.4 9.6 5.8 10.7 5.8 13.1 5.8 13.5 7.4 13.5 9.4V13.6H13.6z" id="Shape"/></g></g></g></g></svg></a><a href=https://github.com/sarinac target=blank><svg width="17" height="17" viewBox="0 0 17 17" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>github</title><g class="portfolio-contact" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="GitHub-Mark" transform="translate(-136.000000, -55.000000)" fill="#505050"><path d="M144.319263 55.455C139.902185 55.455 136.32 59.0366937 136.32 63.4552456 136.32 66.9897924 138.612029 69.9880428 141.791009 71.0459021 142.191267 71.1195692 142.337128 70.8725389 142.337128 70.6603777 142.337128 70.4708077 142.330252 69.967416 142.326323 69.2999922 140.101086 69.7832483 139.631581 68.2273994 139.631581 68.2273994 139.267666 67.303123 138.743156 67.057075 138.743156 67.057075 138.016799 66.5610499 138.798161 66.5708722 138.798161 66.5708722 139.601132 66.6273503 140.02349 67.3954524 140.02349 67.3954524 140.737078 68.617835 141.896107 68.2647241 142.351861 68.0599296 142.424546 67.5432777 142.631305 67.1906579 142.859673 66.9907746 141.083314 66.7889268 139.215608 66.1023495 139.215608 63.0368165 139.215608 62.163616 139.527465 61.4490452 140.039206 60.8901576 139.956698 60.6878187 139.682166 59.8740429 140.117784 58.7729656 140.117784 58.7729656 140.789137 58.5578577 142.317483 59.5931258 142.95544 59.4153426 143.640053 59.326942 144.320246 59.3235043 144.999947 59.326942 145.684069 59.4153426 146.323008 59.5931258 147.850372 58.5578577 148.520743 58.7729656 148.520743 58.7729656 148.957343 59.8740429 148.68281 60.6878187 148.600794 60.8901576 149.113517 61.4490452 149.422919 62.163616 149.422919 63.0368165 149.422919 66.1102073 147.552266 66.7864712 145.770505 66.9843901 146.057315 67.2314204 146.313186 67.7195876 146.313186 68.4660808 146.313186 69.5352357 146.303364 70.3981229 146.303364 70.6603777 146.303364 70.8745034 146.447751 71.1234981 146.853411 71.045411 150.029936 69.9850961 152.32 66.9888101 152.32 63.4552456 152.32 59.0366937 148.737815 55.455 144.319263 55.455" id="Fill-4"/></g></g></svg></a></div></div><div class=footer-inner-center><p>I created my website with <a href=https://gohugo.io/>Hugo</a>.</p></div><div class=footer-inner-right><p><a href=https://ifcolorful.com/>Sarina Chen</a></p></div></div><script src=https://ifcolorful.com/js/jquery-1.js></script><script src=https://ifcolorful.com/js/stickUp.js></script><script src=https://ifcolorful.com/js/scrollIt.js type=text/javascript></script><script type=text/javascript>jQuery(function($){$(document).ready(function(){$('.main-navigation').stickUp({});});});$(function(){$.scrollIt({topOffset:-70,easing:'ease-in-out'});});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YQC37FT3TK"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-YQC37FT3TK');</script></footer></body></html>